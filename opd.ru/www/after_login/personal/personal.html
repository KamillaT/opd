<?php
    include("../../php/auth_session.php");
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–µ—Ä—Å–æ–Ω–∞–ª</title>
    <link rel="stylesheet" href="../../css/personal.css">
    <link rel="stylesheet" href="../../css/stars.css">
    <style>
        body{
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <div id="stars"></div>
        <div id="stars2"></div>
        <div id="stars3"></div>
        <div id="stars4"></div>
    </div>
    <body>
        <input type="checkbox" name="" id="menu-toggle">
        <div class="overlay">
            <label for="menu-toggle" ></label>
        </div>
    
        <div class="sidebar">
            <div class="sidebar-container">
                <div class="brand">
                    <h2>
                        <span class="lab la-staylinked"></span>
                        Lunimous Dragon
                    </h2>
                </div>
    
                <div class="sidebar-avartar">
                    <div style="display: flex;">
                        <img src="../../images/user_icon.jpg" alt="">
                    </div>
                    <div class="avartar-info">
                        <div class="avartar-text">
                            <h4><?php echo $_SESSION['username'];?></h4>
                            <small>user id</small>
                        </div>
                        <span class="las la-angle-double-down"></span>
                    </div>
                </div>
                <div class="sidebar-menu">
                    <ul>
                        <li>
                            <a href="" class="active">
                                <span class="las la-adjust"></span>
                                <span>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–æ–≤</span>
                            </a>
                        </li>
                        <li>
                            <a href="personal-analytic.html">
                                <span class="las la-analis"></span>
                                <span>–ê–Ω–∞–ª–∏–∑</span>
                            </a>
                        </li>
                        
                    </ul>
                </div>
                <div class="sidebar-menu1">
                    <li>
                        <a href="personal-site.html">
                            <span class="las site-user"></span>
                            <span>–ù–∞—Å—Ç–æ–π–∫–∞</span>
                        </a>
                    </li>
                </div>
            </div>
        </div>
    
        <div class="main-content">
            <header>
                <div class="header-title-wrapper">
                    <label for="menu-toggle">
                        <span class="las la-bars"></span>
                    </label>
                    <div class="header-title">
                        <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç  —Ç–µ—Å—Ç–æ–≤</h1>
                        <p>–í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –Ω–∞—à–µ–º —Å–∞–π—Ç–µ ‚Äî‚Äî‚Äî‚Äî<span class="las la-chart-line"></span></p>
                    </div>
                </div>
                <div class="header-action">
                    <button class="btn btn-main" id="upload">
                        <span class="las la-video">Upload</span>
                    </button>
                    <script src="../../js/upload.js"></script>
                </div>
            </header>
            <main>
                <section>
                    <h3 class="section-head">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —Ç–µ—Å—Ç–∞</h3>
                    <div class="analytics">
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test1">üîä</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–†–µ–∞–∫—Ü–∏—è –Ω–∞ –∑–≤—É–∫</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test1">üîä</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–†–µ–∞–∫—Ü–∏—è –Ω–∞ –∑–≤—É–∫ (—Å–ª–æ–∂–Ω–∞—è)</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test2">üéÜ</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–†–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–≤–µ—Ç (–ø—Ä–æ—Å—Ç–∞—è)</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test3">üéÜ</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–†–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–≤–µ—Ç (—Å–ª–æ–∂–Ω–∞—è)</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test4">üßÆ</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–†–µ–∞–∫—Ü–∏—è –Ω–∞ —Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test5">ü§æ‚Äç‚ôÄÔ∏è</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–†–î–û (–ø—Ä–æ—Å—Ç–∞—è)</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test6">ü§æ‚Äç‚ôÄÔ∏è</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–†–î–û (—Å–ª–æ–∂–Ω–∞—è)</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test7">üïµÔ∏è</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–ê–Ω–∞–ª–æ–≥–æ–≤–æ–µ —Å–ª–µ–∂–µ–Ω–∏–µ</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test8">üïµÔ∏è</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–ê–Ω–∞–ª–æ–≥–æ–≤–æ–µ –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test9">ü´µ</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–í–Ω–∏–º–∞–Ω–∏–µ</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test10">üß†</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–ü–∞–º—è—Ç—å</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                        <div class="analytic">
                            <div class="analytic-icon">
                                <span class="test11">üí≠</span>
                            </div>
                            <div class="analytic-info">
                                <h4>–ú—ã—à–ª–µ–Ω–∏–µ</h4>
                                <h2>ball</h2>
                                <h5>–ø–æ–ø—ã—Ç–æ–∫:</h5>
                            </div>
                        </div>
                    </div>
                </section>
    
                <section>
                    <div class="block-grid">
                        <div class="revenue-card">
                            <h3 class="section-head" style="text-align: center;">–ö–∞—Ä—å–µ—Ä–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</h3>
                            <div class="rev-content">
                                <img src="../../images/data.png" alt="">
                                <div class="rev-info">
                                    <h3>–ü—Ä–æ—Ñ–µ—Å—Å–∏—è</h3>
                                    <h1>–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è</h1>
                                </div>
                            </div>
                        </div>
                        <div class="graph-card" style="align-items: center;">
                            <h3 class="section-head">Graph</h3>
                            <div class="graph-content">
                                <div class="graph-head">
                                    <div class="icons-wrapper">
                                        <div class="icon">
                                            <span class="las la-eye text-main"></span>
                                        </div>
                                        <div class="icon">
                                            <span class="las la-clock text-success"></span>
                                        </div>
                                    </div>
                                    <div class="graph-select">
                                        <select name="" id="">
                                            <option value="">–†–µ–∞–∫—Ü–∏—è –Ω–∞ –∑–≤—É–∫</option>
                                            <option value="">–†–µ–∞–∫—Ü–∏—è –Ω–∞ –∑–≤—É–∫ (—Å–ª–æ–∂–Ω–∞—è)</option>
                                            <option value="">–†–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–≤–µ—Ç</option>
                                            <option value="">–†–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–≤–µ—Ç (—Å–ª–æ–∂–Ω–∞—è)</option>

                                            <option value="">–†–µ–∞–∫—Ü–∏—è –Ω–∞ —Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</option>
                                            <option value="">–†–î–û</option>
                                            <option value="">–†–î–û (—Å–ª–æ–∂–Ω–∞—è)</option>
                                            <option value="">–ê–Ω–∞–ª–æ–≥–æ–≤–æ–µ —Å–ª–µ–∂–µ–Ω–∏–µ</option>

                                            <option value="">–ê–Ω–∞–ª–æ–≥–æ–≤–æ–µ –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</option>
                                            <option value="">–í–Ω–∏–º–∞–Ω–∏–µ</option>
                                            <option value="">–ü–∞–º—è—Ç—å</option>
                                            <option value="">–ú—ã—à–ª–µ–Ω–∏–µ</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="graph-board">
                                    <canvas id="revenueChart"></canvas>
                                </div>
                            </div>
                            <!-- <?php
                                $conn = new mysqli("localhost", "root", "", "users");
                                $username = $_SESSION['username'];
                                $result = $conn->query("SELECT id FROM user_data WHERE username = '$username'");
                                $row = $result->fetch_array(MYSQLI_ASSOC);
                                $user_id = (int) $row['id'];

                                $check_table = $conn->query("SHOW TABLES LIKE 'test_results'");
                                if ($check_table->num_rows==0) {
                                    echo '';
                                }
                                else {
                                    $res = $conn->query("SELECT * FROM test_results WHERE user_id = $user_id");
                                    if ($res->num_rows==0) {
                                        echo '';
                                    }
                                else {
                                    echo '';
                                    echo '';
                                    while ($r = $res->fetch_array(MYSQLI_ASSOC)) {
                                        echo '<tr>'.$r['correct'].'</td></tr>';
                                        
                                    }
                                }
                            }
                            ?> -->
                            <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.js"></script>
                            <script>
                                Chart.defaults.global.defaultFontFamily = "Kanit";
                                let ctx = document.querySelector("#revenueChart");

                                let revChart = new Chart(ctx,{
                                    type:"line",
                                    data:{
                                        labels:["Sept 1","Sept 3","Sept 6","Sept 9","Sept 12","Sept 15"
                                        ,"Sept 18","Sept 21","Sept 24","Sept 27","Sept 30"],
                                        datasets:[
                                            
                                            {
                                                label:"WatchTime",
                                                borderColor:"green",
                                                borderWidth:"3",
                                                backgroundColor:"rgba(235,247,245,0.7)",
                                                data:[0,30,60,25,60,25,50,10,50,90,120]
                                            },
                                            // {
                                            //     label:"TotalViews",
                                            //     borderColor:"blue",
                                            //     borderWidth:"3",
                                            //     backgroundColor:"rgba(233,238,253,0.7)",
                                            //     data:[0,60,25,100,20,75,30,55,20,60,20]
                                            // }
                                        ]
                                    },
                                    options:{
                                        responsive:true,
                                        tooltips:{
                                            intersect:false,
                                            node:"index",
                                        }
                                    }
                                });
                            </script>
                        </div>
                    </div>
                    <div class="test-card" style="align-items: center; margin-top: 50px;">
                        <?php
                            $conn = new mysqli("localhost", "root", "", "users");
                            $username = $_SESSION['username'];
                            $result = $conn->query("SELECT id FROM user_data WHERE username = '$username'");
                            $row = $result->fetch_array(MYSQLI_ASSOC);
                            $user_id = (int) $row['id'];

                            $check_table = $conn->query("SHOW TABLES LIKE 'test_results'");
                            if ($check_table->num_rows==0) {
                                echo '<div class="no-table" style="margin: auto;">
                                        <p style="color: azure; margin: 0px 0px 30px;">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞ –Ω–µ—Ç, –Ω–∞–∂–∏–º–∏—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
                                        <button class="btn btn-main" style="margin: auto;">
                                            <span class="las la-video">
                                                <a href="../test.html" style="color: #ffffff;">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
                                            </span>
                                        </button>
                                    </div>';
                            }
                            else {
                                $res = $conn->query("SELECT * FROM test_results WHERE user_id = $user_id");
                                if ($res->num_rows==0) {
                                    echo '<div class="no-table" style="margin: auto;">
                                            <p style="color: azure; margin: 0px 0px 30px;">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞ –Ω–µ—Ç, –Ω–∞–∂–∏–º–∏—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
                                            <button class="btn btn-main" style="margin: auto;">
                                                <span class="las la-video">
                                                    <a href="../test.html" style="color: #ffffff;">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
                                                </span>
                                            </button>
                                        </div>';
                                }
                                else {
                                    echo '<div style="margin: 0px 0px 30px;">
                                            <button class="btn btn-main">
                                                <span class="las la-video">
                                                    <a href="../test.html" style="color: #ffffff;">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
                                                </span>
                                            </button>
                                        </div>';
                                    echo '<table style="width: 100%; text-align: center ;color: azure; background-color: rgba(239, 211, 255, 0.23); border-collapse: collapse;"><tr><th>–¢–µ—Å—Ç</th><th>avg_time</th><th>total_time</th><th>correct</th><th>misses</th><th>score</th></tr>';
                                    while ($r = $res->fetch_array(MYSQLI_ASSOC)) {
                                        echo '<tr><td>'.$r['test_name'].'</td><td>'.$r['avg_time'].'</td><td>'.$r['total_time'].'</td><td>'.$r['correct'].'</td><td>'.$r['misses'].'</td><td>'.$r['score'].'</td></tr>';
                                        
                                    }
                                }
                                
                            }
                            
                        ?>
                    </div>
                </section>
    
            </main>
        </div>
</body>
</html>